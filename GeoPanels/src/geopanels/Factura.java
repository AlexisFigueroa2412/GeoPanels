/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package geopanels;
import Clases.ClaseFactura;
import Clases.ClaseCarrito;
import java.awt.HeadlessException;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import java.util.Arrays;
import java.util.Date;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
/**
 *
 * @author jalex
 */
public class Factura extends javax.swing.JPanel {
    
    FiltroCarro ca = new FiltroCarro();
    ClaseFactura fac = new ClaseFactura(); 
    ClaseCarrito car = new ClaseCarrito();
    public static ResultSet retorno;
    public static ResultSet retorno2;
    
    /**
     * Creates new form Factura
     */
    public Factura() {
        initComponents();
        txtIdCliente.setVisible(false);
        txtIdCarrito.setVisible(false);
        txtPrecioInstalacion.setVisible(false);
        txtPrecioImpuesto.setVisible(false);
        txtIdInstalacion.setVisible(false);
        txtIdImpuesto.setVisible(false);
        DarFecha();
        comboImpuesto();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel4 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        jLabel14 = new javax.swing.JLabel();
        jLabel15 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        btnCliente = new javax.swing.JButton();
        btnGuardar = new javax.swing.JButton();
        btnAbrirCarro = new javax.swing.JButton();
        btnLimpar = new javax.swing.JButton();
        txtFecha = new javax.swing.JTextField();
        txtCliente = new javax.swing.JTextField();
        txtCarro = new javax.swing.JTextField();
        txtSubtotal = new javax.swing.JTextField();
        cmbInstalacion = new javax.swing.JComboBox<>();
        cmbImpuesto = new javax.swing.JComboBox<>();
        txtTotal = new javax.swing.JTextField();
        txtIdCliente = new javax.swing.JTextField();
        txtIdCarrito = new javax.swing.JTextField();
        txtPrecioImpuesto = new javax.swing.JTextField();
        txtPrecioInstalacion = new javax.swing.JTextField();
        txtIdInstalacion = new javax.swing.JTextField();
        txtIdImpuesto = new javax.swing.JTextField();

        setBackground(new java.awt.Color(42, 51, 56));
        setLayout(new java.awt.BorderLayout());

        jPanel4.setBackground(new java.awt.Color(42, 51, 56));

        jLabel2.setBackground(new java.awt.Color(255, 255, 255));
        jLabel2.setFont(new java.awt.Font("Segoe UI Light", 0, 24)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(149, 162, 166));
        jLabel2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Multimedia/Factura.png"))); // NOI18N
        jLabel2.setText("Factura");
        jLabel2.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
        jLabel2.setIconTextGap(20);

        jLabel8.setFont(new java.awt.Font("Segoe UI Light", 0, 14)); // NOI18N
        jLabel8.setForeground(new java.awt.Color(149, 162, 166));
        jLabel8.setText("Fecha : ");

        jLabel5.setFont(new java.awt.Font("Segoe UI Light", 0, 14)); // NOI18N
        jLabel5.setForeground(new java.awt.Color(149, 162, 166));
        jLabel5.setText("Cliente : ");

        jLabel10.setFont(new java.awt.Font("Segoe UI Light", 0, 14)); // NOI18N
        jLabel10.setForeground(new java.awt.Color(149, 162, 166));
        jLabel10.setText("Instalación : ");

        jLabel12.setFont(new java.awt.Font("Segoe UI Light", 0, 14)); // NOI18N
        jLabel12.setForeground(new java.awt.Color(149, 162, 166));
        jLabel12.setText("Total : ");

        jLabel14.setFont(new java.awt.Font("Segoe UI Light", 0, 14)); // NOI18N
        jLabel14.setForeground(new java.awt.Color(149, 162, 166));
        jLabel14.setText("Impuesto : ");

        jLabel15.setFont(new java.awt.Font("Segoe UI Light", 0, 14)); // NOI18N
        jLabel15.setForeground(new java.awt.Color(149, 162, 166));
        jLabel15.setText("Subtotal : ");

        jLabel6.setFont(new java.awt.Font("Segoe UI Light", 0, 14)); // NOI18N
        jLabel6.setForeground(new java.awt.Color(149, 162, 166));
        jLabel6.setText("Carrito : ");

        btnCliente.setBackground(new java.awt.Color(27, 35, 41));
        btnCliente.setFont(new java.awt.Font("Segoe UI Light", 0, 10)); // NOI18N
        btnCliente.setForeground(new java.awt.Color(149, 162, 166));
        btnCliente.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Multimedia/Filtro.png"))); // NOI18N
        btnCliente.setText("Filtro");
        btnCliente.setBorderPainted(false);
        btnCliente.setContentAreaFilled(false);
        btnCliente.setOpaque(true);
        btnCliente.setSelectedIcon(new javax.swing.ImageIcon(getClass().getResource("/Multimedia/Filtro Hover.png"))); // NOI18N
        btnCliente.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btnClienteMouseClicked(evt);
            }
        });
        btnCliente.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnClienteActionPerformed(evt);
            }
        });

        btnGuardar.setBackground(new java.awt.Color(27, 35, 41));
        btnGuardar.setFont(new java.awt.Font("Segoe UI Light", 0, 12)); // NOI18N
        btnGuardar.setForeground(new java.awt.Color(149, 162, 166));
        btnGuardar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Multimedia/Añadir.png"))); // NOI18N
        btnGuardar.setText("Guardar Factura");
        btnGuardar.setBorderPainted(false);
        btnGuardar.setContentAreaFilled(false);
        btnGuardar.setOpaque(true);
        btnGuardar.setSelectedIcon(new javax.swing.ImageIcon(getClass().getResource("/Multimedia/Añadir Hover.png"))); // NOI18N
        btnGuardar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnGuardarActionPerformed(evt);
            }
        });

        btnAbrirCarro.setBackground(new java.awt.Color(27, 35, 41));
        btnAbrirCarro.setFont(new java.awt.Font("Segoe UI Light", 0, 10)); // NOI18N
        btnAbrirCarro.setForeground(new java.awt.Color(149, 162, 166));
        btnAbrirCarro.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Multimedia/Filtro.png"))); // NOI18N
        btnAbrirCarro.setText("Filtro");
        btnAbrirCarro.setBorderPainted(false);
        btnAbrirCarro.setContentAreaFilled(false);
        btnAbrirCarro.setOpaque(true);
        btnAbrirCarro.setSelectedIcon(new javax.swing.ImageIcon(getClass().getResource("/Multimedia/Filtro Hover.png"))); // NOI18N
        btnAbrirCarro.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btnAbrirCarroMouseClicked(evt);
            }
        });
        btnAbrirCarro.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAbrirCarroActionPerformed(evt);
            }
        });

        btnLimpar.setBackground(new java.awt.Color(42, 51, 56));
        btnLimpar.setFont(new java.awt.Font("Segoe UI Light", 0, 10)); // NOI18N
        btnLimpar.setForeground(new java.awt.Color(149, 162, 166));
        btnLimpar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Multimedia/Toalla.png"))); // NOI18N
        btnLimpar.setText("Limpiar");
        btnLimpar.setToolTipText("Limpiar Campos");
        btnLimpar.setBorderPainted(false);
        btnLimpar.setContentAreaFilled(false);
        btnLimpar.setOpaque(true);
        btnLimpar.setSelectedIcon(new javax.swing.ImageIcon(getClass().getResource("/Multimedia/Toalla Hover.png"))); // NOI18N
        btnLimpar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLimparActionPerformed(evt);
            }
        });

        txtFecha.setDisabledTextColor(new java.awt.Color(0, 0, 0));
        txtFecha.setEnabled(false);

        txtCliente.setFont(new java.awt.Font("Segoe UI Light", 0, 11)); // NOI18N
        txtCliente.setForeground(new java.awt.Color(50, 54, 59));
        txtCliente.setDisabledTextColor(new java.awt.Color(0, 0, 0));
        txtCliente.setEnabled(false);

        txtCarro.setFont(new java.awt.Font("Segoe UI Light", 0, 11)); // NOI18N
        txtCarro.setForeground(new java.awt.Color(50, 54, 59));
        txtCarro.setDisabledTextColor(new java.awt.Color(0, 0, 0));
        txtCarro.setEnabled(false);

        txtSubtotal.setText("0.0");
        txtSubtotal.setDisabledTextColor(new java.awt.Color(0, 0, 0));
        txtSubtotal.setEnabled(false);

        cmbInstalacion.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Seleccione", "Instalación de Paneles", "Sin Instalación" }));
        cmbInstalacion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmbInstalacionActionPerformed(evt);
            }
        });

        cmbImpuesto.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        cmbImpuesto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmbImpuestoActionPerformed(evt);
            }
        });

        txtTotal.setText("0.0");
        txtTotal.setDisabledTextColor(new java.awt.Color(0, 0, 0));
        txtTotal.setEnabled(false);
        txtTotal.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtTotalActionPerformed(evt);
            }
        });
        txtTotal.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                txtTotalKeyTyped(evt);
            }
        });

        txtIdCliente.setFont(new java.awt.Font("Segoe UI Light", 0, 11)); // NOI18N
        txtIdCliente.setForeground(new java.awt.Color(50, 54, 59));
        txtIdCliente.setEnabled(false);

        txtIdCarrito.setFont(new java.awt.Font("Segoe UI Light", 0, 11)); // NOI18N
        txtIdCarrito.setForeground(new java.awt.Color(50, 54, 59));
        txtIdCarrito.setEnabled(false);

        txtPrecioImpuesto.setFont(new java.awt.Font("Segoe UI Light", 0, 11)); // NOI18N
        txtPrecioImpuesto.setForeground(new java.awt.Color(50, 54, 59));
        txtPrecioImpuesto.setText("0.0");
        txtPrecioImpuesto.setEnabled(false);

        txtPrecioInstalacion.setFont(new java.awt.Font("Segoe UI Light", 0, 11)); // NOI18N
        txtPrecioInstalacion.setForeground(new java.awt.Color(50, 54, 59));
        txtPrecioInstalacion.setText("0.0");
        txtPrecioInstalacion.setEnabled(false);
        txtPrecioInstalacion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtPrecioInstalacionActionPerformed(evt);
            }
        });

        txtIdInstalacion.setFont(new java.awt.Font("Segoe UI Light", 0, 11)); // NOI18N
        txtIdInstalacion.setForeground(new java.awt.Color(50, 54, 59));
        txtIdInstalacion.setEnabled(false);

        txtIdImpuesto.setFont(new java.awt.Font("Segoe UI Light", 0, 11)); // NOI18N
        txtIdImpuesto.setForeground(new java.awt.Color(50, 54, 59));
        txtIdImpuesto.setEnabled(false);

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                        .addGap(561, 561, 561)
                        .addComponent(btnGuardar, javax.swing.GroupLayout.PREFERRED_SIZE, 133, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(jLabel10, javax.swing.GroupLayout.Alignment.TRAILING)
                                        .addComponent(jLabel14))
                                    .addComponent(jLabel15)
                                    .addComponent(jLabel6))
                                .addGap(20, 20, 20)
                                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addComponent(txtCarro)
                                    .addComponent(txtSubtotal, javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(cmbInstalacion, javax.swing.GroupLayout.Alignment.LEADING, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(cmbImpuesto, javax.swing.GroupLayout.Alignment.LEADING, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(txtTotal, javax.swing.GroupLayout.Alignment.LEADING))
                                .addGap(18, 18, 18)
                                .addComponent(btnAbrirCarro, javax.swing.GroupLayout.PREFERRED_SIZE, 99, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addComponent(jLabel12)
                                .addGap(0, 0, Short.MAX_VALUE))
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addComponent(jLabel2)
                                .addGap(18, 18, 18)
                                .addComponent(txtIdCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(txtIdCarrito, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(txtPrecioInstalacion, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(txtPrecioImpuesto, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(txtIdInstalacion, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(txtIdImpuesto, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(btnLimpar))))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addContainerGap()
                                .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 75, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addGap(12, 12, 12)
                                .addComponent(jLabel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtFecha)
                            .addComponent(txtCliente))
                        .addGap(18, 18, 18)
                        .addComponent(btnCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 99, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel2)
                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(btnLimpar)
                        .addComponent(txtIdCliente, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(txtIdCarrito, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(txtPrecioImpuesto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(txtPrecioInstalacion, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(txtIdInstalacion, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(txtIdImpuesto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(67, 67, 67)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel8)
                    .addComponent(txtFecha, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtCliente, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel5)
                    .addComponent(btnCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtCarro, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel6)
                    .addComponent(btnAbrirCarro, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel15)
                    .addComponent(txtSubtotal, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel10)
                    .addComponent(cmbInstalacion, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel14)
                    .addComponent(cmbImpuesto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel12)
                    .addComponent(txtTotal, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(33, 33, 33)
                .addComponent(btnGuardar, javax.swing.GroupLayout.PREFERRED_SIZE, 49, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(45, Short.MAX_VALUE))
        );

        add(jPanel4, java.awt.BorderLayout.CENTER);
    }// </editor-fold>//GEN-END:initComponents
    
    //Fecha
    public void DarFecha(){
        Date objDate = new Date(); 
        String strDateFormat = "dd-MM-yyyy"; 
        SimpleDateFormat objSDF = new SimpleDateFormat(strDateFormat);
        txtFecha.setText(objSDF.format(objDate));
    }
    
    public void comboImpuesto(){
        cmbImpuesto.setModel(fac.Impuesto());
    }
    
    public void Total(){
        
        double subtotal;
        double impuesto;
        double instalacion;
        double total;
        
        subtotal = Double.parseDouble(txtSubtotal.getText());
        impuesto = Double.parseDouble(txtPrecioImpuesto.getText());
        instalacion = Double.parseDouble(txtPrecioInstalacion.getText());
        
        total = subtotal + impuesto + instalacion;
        txtTotal.setText(String.valueOf(total));
        String cadena = txtTotal.getText();
        String[] parts = cadena.split("\\.");      
        String cadena2 = parts[1];
        if(cadena2.length()==1){
            txtTotal.setText(cadena+0);
        }else if (cadena2.length()==0) {
            txtTotal.setText(cadena+00);
        }
        
    }
    private void btnClienteMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnClienteMouseClicked
        // TODO add your handling code here:
        FiltroCliente fli = new FiltroCliente();
        fli.setVisible(true);
    }//GEN-LAST:event_btnClienteMouseClicked

    private void btnClienteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnClienteActionPerformed
        // TODO add your handling code here:
        
    }//GEN-LAST:event_btnClienteActionPerformed

    private void btnAbrirCarroMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnAbrirCarroMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_btnAbrirCarroMouseClicked

    private void btnAbrirCarroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAbrirCarroActionPerformed
        // TODO add your handling code here:
        ca.setVisible(true);        
    }//GEN-LAST:event_btnAbrirCarroActionPerformed

    public void Conseguir_Id(){
        fac.setInstalacion((String)cmbInstalacion.getSelectedItem());
        //JOptionPane.showMessageDialog(this, "Precio de Instalación" +(String)cmbInstalacion.getSelectedItem());
        //JOptionPane.showMessageDialog(this, "Precio de Instalación" + fac.getInstalacion());
        retorno2 = fac.Obtener_idInstalacion();                            
            try{
                //JOptionPane.showMessageDialog(this, "Precio de Instalación" + fac.getInstalacion());
                while(retorno2.next())
                {
                    //JOptionPane.showMessageDialog(this, "Id de Instalación" + retorno2.getString(1));
                    txtIdInstalacion.setText(retorno2.getString(1));
                    
                }
            }
            catch(SQLException e){
                JOptionPane.showMessageDialog(this, "No se pudo obtener el precio de Instalación" + e);
            }        
    }
    
    private void cmbInstalacionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmbInstalacionActionPerformed
        // TODO add your handling code here:
        //JOptionPane.showMessageDialog(this, "Instalación " +(String)cmbInstalacion.getSelectedItem());
        fac.setInstalacion((String)cmbInstalacion.getSelectedItem());
        retorno = fac.Obtener_Precio_Instalacion();
        try{
            //JOptionPane.showMessageDialog(this, "Instalación " +fac.getInstalacion());
            while(retorno.next())
            {
                //JOptionPane.showMessageDialog(this, "Precio de Instalación" +retorno.getString(1));
                txtPrecioInstalacion.setText(retorno.getString(1));                            
                Total();         
                Conseguir_Id();
            }
        }
        catch(HeadlessException | SQLException e){
            JOptionPane.showMessageDialog(this, "No se pudo obtener el precio de Instalación" + e);
        }
    }//GEN-LAST:event_cmbInstalacionActionPerformed

    private void cmbImpuestoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmbImpuestoActionPerformed
        // TODO add your handling code here:
        
        String cadena =(String) cmbImpuesto.getSelectedItem();
        String[] parts = cadena.split("\\$");
        txtPrecioImpuesto.setText(parts[1]);
        Total();
        txtIdImpuesto.setText(String.valueOf(cmbImpuesto.getSelectedIndex()));
        //JOptionPane.showMessageDialog(this, "ID " + String.valueOf(cmbImpuesto.getSelectedIndex()));
//        int id = cmbImpuesto.getSelectedIndex();
//        id = id+1;
//        fac.setIdImpuesto(id);
    //        fac.setImpuesto(parts[0]);
    //        fac.setPrecioImpusto(Double.parseDouble(parts[1]));
    //        JOptionPane.showMessageDialog(this, "precio del impuesto" + fac.getPrecioImpusto()+"impuesto"+ fac.getImpuesto());
    //        retorno = fac.Obtener_Precio_Impuesto();
    //        try{
    //                        while(retorno.next())
    //                        {
    //                            JOptionPane.showMessageDialog(this, "Id de Impuesto" + retorno.getString(1));
    //                            txtIdImpuesto.setText(retorno.getString(1));
    //                        }
    //                    }
    //        catch(HeadlessException | SQLException e){
    //            JOptionPane.showMessageDialog(this, "No se pudo obtener el precio del impuesto " + e);
    //        }
        
    }//GEN-LAST:event_cmbImpuestoActionPerformed

    public void Limpiar(){
    txtCarro.setText("");
    txtCliente.setText("");
    txtIdCarrito.setText("");
    txtIdCliente.setText("");
    txtIdImpuesto.setText("");
    txtIdInstalacion.setText("");
    txtPrecioImpuesto.setText("0.0");
    txtPrecioInstalacion.setText("0.0");
    txtSubtotal.setText("0.0");
    txtTotal.setText("0.0");
    DarFecha();
    comboImpuesto();
    cmbInstalacion.setSelectedIndex(0);
    }
    public void Fac_carro(){
        String carrito = txtCarro.getText()+"*Facturado";
        car.setcarrito(carrito);
        car.setid_carrito(Integer.parseInt(txtIdCarrito.getText()));
        try{
                if (car.Carrito_Facturado()) {
                    JOptionPane.showMessageDialog(this, "Datos guardados");
                    Limpiar();
                }
                else{
                    JOptionPane.showMessageDialog(this, "Error al guardar datos");
                }
            }
            catch (HeadlessException ex) {
                Logger.getLogger(Factura.class.getName()).log(Level.SEVERE, null, ex);
            }
        
    }
    private void btnGuardarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnGuardarActionPerformed
        // TODO add your handling code here:
        if (!txtFecha.getText().isEmpty() && !txtSubtotal.getText().isEmpty() && !txtIdCarrito.getText().isEmpty() && !txtIdInstalacion.getText().isEmpty() && !txtIdCliente.getText().isEmpty() && !txtIdImpuesto.getText().isEmpty() && !txtTotal.getText().isEmpty()) {
            fac.setFecha(txtFecha.getText());
            fac.setSubtotal(Double.parseDouble(txtSubtotal.getText()));
            fac.setIdCarro(Integer.parseInt(txtIdCarrito.getText()));
            String cadena = txtTotal.getText();
            String[] parts = cadena.split("\\.");      
            String cadena2 = parts[1];
            if(cadena2.length()==1){
                txtTotal.setText(cadena+0);
            }else if (cadena2.length()==0) {
                txtTotal.setText(cadena+00);
            }
            fac.setIdInstalacion(Integer.parseInt(txtIdInstalacion.getText()));
            fac.setClienteId(Integer.parseInt(txtIdCliente.getText()));
            fac.setIdImpuesto(Integer.parseInt(txtIdImpuesto.getText()));
            fac.setTotal(Double.parseDouble(txtTotal.getText())); 
            fac.setPago(1);
            
            try{
//                JOptionPane.showMessageDialog(this, "Fecha " + fac.getFecha()+" sub "+fac.getSubtotal()+
//                " carro "+fac.getIdCarro()+" inst "+fac.getIdInstalacion()+" Cliente "+fac.getClienteId()+
//                " impuesto "+fac.getIdImpuesto()+" total "+fac.getTotal()+" pago "+fac.getPago());
                if (fac.Añadir_factura()) {
                    Fac_carro();
//                    JOptionPane.showMessageDialog(this, "Datos guardados");
                    Limpiar();
                }
                else{
                    JOptionPane.showMessageDialog(this, "Error al guardar datos");
                }
            }
            catch (HeadlessException ex) {
                Logger.getLogger(Factura.class.getName()).log(Level.SEVERE, null, ex);
            }
        }else{
            JOptionPane.showMessageDialog(this, "No dejes campos vacíos");
        }
    }//GEN-LAST:event_btnGuardarActionPerformed

    private void txtPrecioInstalacionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtPrecioInstalacionActionPerformed
        // TODO add your handling code here:
        
    }//GEN-LAST:event_txtPrecioInstalacionActionPerformed

    private void btnLimparActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLimparActionPerformed
        // TODO add your handling code here:
        Limpiar();
    }//GEN-LAST:event_btnLimparActionPerformed

    private void txtTotalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtTotalActionPerformed
        // TODO add your handling code here:
//        String cadena = txtTotal.getText();
//        String[] parts = cadena.split("\\.");      
//        String cadena2 = parts[1];
//        if (1<cadena2.length()) {
//            txtTotal.setText(cadena+"0");
//        }        
    
    }//GEN-LAST:event_txtTotalActionPerformed

    private void txtTotalKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtTotalKeyTyped
        // TODO add your handling code here:
        
//        if (cadena2.length() ==1) {
//            txtTotal.setText(cadena+"0");
//            JOptionPane.showMessageDialog(this, "Precio "+txtTotal.getText());
//        }
    }//GEN-LAST:event_txtTotalKeyTyped


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnAbrirCarro;
    private javax.swing.JButton btnCliente;
    private javax.swing.JButton btnGuardar;
    private javax.swing.JButton btnLimpar;
    private javax.swing.JComboBox<String> cmbImpuesto;
    private javax.swing.JComboBox<String> cmbInstalacion;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JPanel jPanel4;
    public static javax.swing.JTextField txtCarro;
    public static javax.swing.JTextField txtCliente;
    public static javax.swing.JTextField txtFecha;
    public static javax.swing.JTextField txtIdCarrito;
    public static javax.swing.JTextField txtIdCliente;
    private javax.swing.JTextField txtIdImpuesto;
    private javax.swing.JTextField txtIdInstalacion;
    private javax.swing.JTextField txtPrecioImpuesto;
    private javax.swing.JTextField txtPrecioInstalacion;
    public static javax.swing.JTextField txtSubtotal;
    public static javax.swing.JTextField txtTotal;
    // End of variables declaration//GEN-END:variables
}
